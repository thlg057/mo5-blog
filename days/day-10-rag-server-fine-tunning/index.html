<!doctype html><html lang=fr dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Day 10 â€“ Fine tuning du RAG server | Premiers pas: DÃ©veloppement Thomson MO5</title><meta name=keywords content="mo5,rag,ai,mcp,docker,vps"><meta name=description content="DixiÃ¨me jour de vibe coding : DÃ©ploiement et fine tuning du RAG server"><meta name=author content><link rel=canonical href=https://thlg057.github.io/mo5-blog/days/day-10-rag-server-fine-tunning/><link crossorigin=anonymous href=https://thlg057.github.io/mo5-blog/assets/css/stylesheet.a090830a421002426baafbd314e38f149d77b4c48a12ee9312700d770b27fb26.css integrity="sha256-oJCDCkIQAkJrqvvTFOOPFJ13tMSKEu6TEnANdwsn+yY=" rel="preload stylesheet" as=style><link rel=icon href=https://thlg057.github.io/mo5-blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://thlg057.github.io/mo5-blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://thlg057.github.io/mo5-blog/favicon-32x32.png><link rel=apple-touch-icon href=https://thlg057.github.io/mo5-blog/apple-touch-icon.png><link rel=mask-icon href=https://thlg057.github.io/mo5-blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=fr href=https://thlg057.github.io/mo5-blog/days/day-10-rag-server-fine-tunning/><link rel=alternate hreflang=en href=https://thlg057.github.io/mo5-blog/en/days/day-10-rag-server-fine-tunning/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-WRQSQ5Y81F"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-WRQSQ5Y81F")}</script><meta property="og:url" content="https://thlg057.github.io/mo5-blog/days/day-10-rag-server-fine-tunning/"><meta property="og:site_name" content="Premiers pas: DÃ©veloppement Thomson MO5"><meta property="og:title" content="Day 10 â€“ Fine tuning du RAG server"><meta property="og:description" content="DixiÃ¨me jour de vibe coding : DÃ©ploiement et fine tuning du RAG server"><meta property="og:locale" content="fr-fr"><meta property="og:type" content="article"><meta property="article:section" content="days"><meta property="article:published_time" content="2026-01-09T00:00:00+00:00"><meta property="article:modified_time" content="2026-01-09T00:00:00+00:00"><meta property="article:tag" content="MO5"><meta property="article:tag" content="RAG"><meta property="article:tag" content="AI"><meta property="article:tag" content="MCP"><meta property="article:tag" content="Docker"><meta property="article:tag" content="Vps"><meta name=twitter:card content="summary"><meta name=twitter:title content="Day 10 â€“ Fine tuning du RAG server"><meta name=twitter:description content="DixiÃ¨me jour de vibe coding : DÃ©ploiement et fine tuning du RAG server"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Days","item":"https://thlg057.github.io/mo5-blog/days/"},{"@type":"ListItem","position":2,"name":"Day 10 â€“ Fine tuning du RAG server","item":"https://thlg057.github.io/mo5-blog/days/day-10-rag-server-fine-tunning/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Day 10 â€“ Fine tuning du RAG server","name":"Day 10 â€“ Fine tuning du RAG server","description":"DixiÃ¨me jour de vibe coding : DÃ©ploiement et fine tuning du RAG server","keywords":["mo5","rag","ai","mcp","docker","vps"],"articleBody":"Dans la continuitÃ© de lâ€™Ã©pisode prÃ©cÃ©dent, je voulais aller un cran plus loin :\ndÃ©ployer mon RAG server sur Internet.\nLâ€™objectif Ã©tait double :\nrendre le serveur accessible depuis lâ€™extÃ©rieur permettre aux coding agents (Copilot, Augment, etc.) dâ€™avoir un contexte prÃ©cis pour aider au dÃ©veloppement sur le MO5 (le projet est dÃ©crit ici : https://retrocomputing-ai.cloud/) DÃ©ployer un RAG, mais pas seulement une API Pour faire le lien entre les agents de code et mon RAG server, jâ€™ai crÃ©Ã© un serveur MCP.\nIl sert dâ€™interface standardisÃ©e entre les outils dâ€™IA (Copilot, Augment, etc.) et mon API RAG.\nEn pratique, la mise en place du MCP server a Ã©tÃ© presque triviale.\nJe nâ€™ai rien eu Ã  modifier de fondamental dans le RAG : toutes les briques existaient dÃ©jÃ .\nLe MCP server nâ€™est ni un nouveau moteur, ni une surcouche complexe.\nCâ€™est simplement une interface / protocole spÃ©cifique qui joue le rÃ´le dâ€™intermÃ©diaire :\nil reÃ§oit les requÃªtes structurÃ©es du coding agent les adapte au format attendu par lâ€™API RAG renvoie les rÃ©ponses dans un format directement exploitable par lâ€™agent Toute lâ€™intelligence reste donc cÃ´tÃ© RAG.\nLe MCP ne fait que traduire et orchestrer.\nQuitte Ã  exposer quelque chose sur Internet, je ne voulais pas juste une API brute.\nAvec un nom de domaine, autant en profiter pour :\nhÃ©berger un petit site HTML expliquant comment configurer le MCP avec Copilot ou Augment exposer proprement lâ€™API documenter tout Ã§a avec Swagger Les sources du MCP server, ainsi quâ€™une page Markdown expliquant son fonctionnement, sont disponibles ici :\nğŸ‘‰ https://github.com/thlg057/mo5-mcp-server\nChoix de lâ€™hÃ©bergement Je voulais pouvoir dÃ©ployer mon image Docker simplement.\nEn regardant ce qui se faisait, je suis rapidement arrivÃ© sur les VPS.\nAprÃ¨s comparaison des prix et des configurations, je suis parti sur :\nHostinger â€“ offre KVM1 4,99 â‚¬ / mois 1 vCPU 4 Go de RAM Ce nâ€™est pas une grosse config, mais Ã§a devrait Ãªtre suffisant pour mon usage.\nBonus apprÃ©ciable : le nom de domaine offert, parfait pour donner une vraie URL au projet.\nArchitecture de dÃ©ploiement Pour la gestion des URLs, jâ€™ai choisi Caddy.\nLâ€™idÃ©e est simple :\n/ â†’ redirection vers mon blog /api â†’ mon API RAG /swagger â†’ documentation interactive de lâ€™API CÃ´tÃ© serveur, jâ€™ai prÃ©parÃ© un rÃ©pertoire de dÃ©ploiement avec :\nle blog (Hugo) les sources de lâ€™API un docker-compose.yml la configuration Caddy Copie du tout sur le VPS Hostinger, installationâ€¦ aucun souci particulier, câ€™est plutÃ´t simple et bien foutu.\nPremier choc : les performances Sur mon Raspberry Pi 4, jâ€™avais dÃ©jÃ  remarquÃ© un problÃ¨me : environ 30 secondes pour obtenir une rÃ©ponse.\nDâ€™aprÃ¨s Augment, le diagnostic Ã©tait clair : le Raspberry nâ€™Ã©tait tout simplement pas assez puissant.\nJe mâ€™attendais donc Ã  une amÃ©lioration nette sur le VPS.\nPremier test en productionâ€¦ catastrophe : toujours ~30 secondes, et des rÃ©sultats pas terribles ğŸ˜¬.\nIl fallait clairement creuserâ€¦\n1. Performance et architecture (vitesse) Le problÃ¨me Au dÃ©part, jâ€™utilisais un service dâ€™embedding local :\nle code .NET appelait des scripts Python le modÃ¨le Ã©tait chargÃ© Ã  la volÃ©e RÃ©sultat :\nchargement du modÃ¨le Ã  chaque requÃªte CPU saturÃ© application instable Au dÃ©but, je pensais que le problÃ¨me venait de la base de donnÃ©es (mauvaises requÃªtes, index mal optimisÃ©s, etc.).\nAprÃ¨s avoir ajoutÃ© pas mal de logs, le verdict est tombÃ© : la base nâ€™Ã©tait pas en cause, mais bien la gÃ©nÃ©ration des chunks et des embeddings.\nAnalyse Charger un modÃ¨le de deep learning (mÃªme â€œpetitâ€ comme E5) est une opÃ©ration lourde. Le faire Ã  chaque requÃªte est totalement inefficace.\nIl fallait une architecture oÃ¹ le modÃ¨le reste â€œchaudâ€, chargÃ© une seule fois en mÃ©moire.\nCe qui a Ã©tÃ© mis en place Micro-service dÃ©diÃ©\nUne API Python indÃ©pendante, basÃ©e sur FastAPI, dans son propre conteneur Docker.\nChargement unique du modÃ¨le\nLe modÃ¨le multilingual-e5-small est chargÃ© une seule fois au dÃ©marrage du service.\nCommunication HTTP\nLe serveur .NET communique dÃ©sormais via des requÃªtes JSON rapides et simples.\nRÃ©sultat Le temps de traitement est passÃ© :\nde plusieurs secondes par chunk Ã  quelques millisecondes LÃ , on commence Ã  respirer.\n2. QualitÃ© de la recherche (SimilarityScore) Le problÃ¨me Avec le modÃ¨le initial :\nscores de similaritÃ© autour de 0.60 rÃ©sultats souvent peu pertinents sections gÃ©nÃ©riques du type â€œErrors to avoidâ€ qui remontaient tout le temps Bref, lâ€™IA avait du mal Ã  comprendre les nuances techniques spÃ©cifiques du MO5.\nAnalyse Deux causes principales :\n1. Le modÃ¨le Le modÃ¨le dâ€™origine nâ€™Ã©tait pas assez performant sur :\nle langage technique le multilingue (franÃ§ais / anglais) 2. La perte de contexte Une fois dÃ©coupÃ© en chunks, le moteur :\nvoyait une suite dâ€™instructions mais oubliait de quel document et de quelle section elles provenaient Par exemple, il ne savait plus si on parlait :\ndu mode texte ou du mode graphique Ce qui a Ã©tÃ© mis en place Changement de modÃ¨le\nPassage Ã  intfloat/multilingual-e5-small â†’ le score de base est passÃ© de 0.61 Ã  0.86\nEnrichissement sÃ©mantique\nModification du code C# pour injecter :\nle titre du document le titre de la section\ndans chaque chunk envoyÃ© Ã  lâ€™IA Nettoyage du Markdown\nSuppression des caractÃ¨res #, **, etc. pour ne conserver que le texte â€œpurâ€ lors de lâ€™indexation\nRÃ©sultat Les documents techniques remontent dÃ©sormais en prioritÃ© nÂ°1 sur les requÃªtes matÃ©rielles (par exemple sur le NMI). Lâ€™IA â€œcomprendâ€ enfin le contexte global de chaque page.\nFine tuning empirique Jâ€™ai fait pas mal de tests pour affiner le comportement :\nsuppression des #, *, etc. taille des chunks taille de lâ€™overlap ordre des champs injectÃ©s dans le contexte Tout a Ã©tÃ© fait de maniÃ¨re empirique, Ã  coups de tests et de comparaisons.\nAide prÃ©cieuse des IA Je ne connais pas grand-chose aux modÃ¨les neuronaux.\nSur ce point :\nGemini mâ€™a beaucoup aidÃ© pour le dÃ©ploiement du service Python pour le choix du modÃ¨le multilingual-e5-small Franchement, sans cette aide, Ã§a aurait Ã©tÃ© beaucoup plus long (et probablement plus douloureux ğŸ˜…).\nTester le RAG en pratique Pour tester concrÃ¨tement le RAG, le plus simple est de passer par le site : ğŸ‘‰ https://retrocomputing-ai.cloud/\nCâ€™est une page de blog qui explique pas Ã  pas comment utiliser le serveur via un coding agent (Copilot, Augment, etc.) en sâ€™appuyant sur le serveur MCP.\nSi vous voulez simplement explorer lâ€™API sans passer par un agent, la documentation Swagger est disponible ici : ğŸ‘‰ https://retrocomputing-ai.cloud/swagger\nVous y trouverez la liste complÃ¨te des endpoints, les formats de requÃªtes et des exemples dâ€™appels pour tester rapidement le RAG.\nÃ‰tat actuel de la documentation La documentation utilisÃ©e par le RAG est encore en cours de mise Ã  jour.\nSuite Ã  mes derniÃ¨res explorations du code du MO5 â€” et en particulier tout ce qui concerne les modes graphiques, je suis en train de revoir et dâ€™enrichir les fichiers de documentation.\nCela signifie que :\ncertaines parties sont dÃ©jÃ  trÃ¨s prÃ©cises (notamment sur le matÃ©riel) dâ€™autres vont encore Ã©voluer au fil des ajouts les rÃ©sultats du RAG vont continuer Ã  sâ€™amÃ©liorer Ã  mesure que la documentation se densifie Bref, le serveur est opÃ©rationnel, mais le contenu quâ€™il exploite est encore vivant (et câ€™est aussi ce qui rend lâ€™expÃ©rience intÃ©ressante).\nConclusion Ce dÃ©ploiement mâ€™a permis de comprendre une chose essentielle :\nUn RAG qui â€œfonctionneâ€ nâ€™est pas forcÃ©ment un RAG utilisable.\nEntre :\nlâ€™architecture la performance la qualitÃ© des embeddings le contexte injectÃ© il y a Ã©normÃ©ment de paramÃ¨tres Ã  ajuster.\nMais une fois les bons choix faits, le gain est immÃ©diat et vraiment satisfaisant.\nLa suite au prochain Ã©pisode ğŸ™‚\n","wordCount":"1236","inLanguage":"fr","datePublished":"2026-01-09T00:00:00Z","dateModified":"2026-01-09T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://thlg057.github.io/mo5-blog/days/day-10-rag-server-fine-tunning/"},"publisher":{"@type":"Organization","name":"Premiers pas: DÃ©veloppement Thomson MO5","logo":{"@type":"ImageObject","url":"https://thlg057.github.io/mo5-blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://thlg057.github.io/mo5-blog/ accesskey=h title="Premiers pas: DÃ©veloppement Thomson MO5 (Alt + H)">Premiers pas: DÃ©veloppement Thomson MO5</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://thlg057.github.io/mo5-blog/en/ title=English aria-label=English>En</a></li></ul></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Day 10 â€“ Fine tuning du RAG server</h1><div class=post-description>DixiÃ¨me jour de vibe coding : DÃ©ploiement et fine tuning du RAG server</div><div class=post-meta><span title='2026-01-09 00:00:00 +0000 UTC'>9 janvier 2026</span>&nbsp;|&nbsp;<span>Traductions:</span><ul class=i18n_list><li><a href=https://thlg057.github.io/mo5-blog/en/days/day-10-rag-server-fine-tunning/>En</a></li></ul></div></header><div class=post-content><p>Dans la continuitÃ© de lâ€™<a href=https://thlg057.github.io/mo5-blog/days/day-6-rag-server/>Ã©pisode prÃ©cÃ©dent</a>, je voulais aller un cran plus loin :<br><strong>dÃ©ployer mon RAG server sur Internet</strong>.</p><p>Lâ€™objectif Ã©tait double :</p><ul><li>rendre le serveur accessible depuis lâ€™extÃ©rieur</li><li>permettre aux <em>coding agents</em> (Copilot, Augment, etc.) dâ€™avoir un <strong>contexte prÃ©cis</strong> pour aider au dÃ©veloppement sur le MO5 (le projet est dÃ©crit ici : <a href=https://retrocomputing-ai.cloud/>https://retrocomputing-ai.cloud/</a>)</li></ul><hr><h2 id=dÃ©ployer-un-rag-mais-pas-seulement-une-api>DÃ©ployer un RAG, mais pas seulement une API<a hidden class=anchor aria-hidden=true href=#dÃ©ployer-un-rag-mais-pas-seulement-une-api>#</a></h2><p>Pour faire le lien entre les agents de code et mon RAG server, jâ€™ai crÃ©Ã© un <strong>serveur MCP</strong>.<br>Il sert dâ€™interface standardisÃ©e entre les outils dâ€™IA (Copilot, Augment, etc.) et mon API RAG.</p><p>En pratique, la mise en place du MCP server a Ã©tÃ© presque triviale.<br>Je nâ€™ai <strong>rien eu Ã  modifier de fondamental dans le RAG</strong> : toutes les briques existaient dÃ©jÃ .</p><p>Le MCP server nâ€™est ni un nouveau moteur, ni une surcouche complexe.<br>Câ€™est simplement une <strong>interface / protocole spÃ©cifique</strong> qui joue le rÃ´le dâ€™intermÃ©diaire :</p><ul><li>il reÃ§oit les requÃªtes structurÃ©es du coding agent</li><li>les adapte au format attendu par lâ€™API RAG</li><li>renvoie les rÃ©ponses dans un format directement exploitable par lâ€™agent</li></ul><p>Toute lâ€™intelligence reste donc cÃ´tÃ© RAG.<br>Le MCP ne fait que <strong>traduire et orchestrer</strong>.</p><p>Quitte Ã  exposer quelque chose sur Internet, je ne voulais pas juste une API brute.<br>Avec un nom de domaine, autant en profiter pour :</p><ul><li>hÃ©berger un petit site HTML expliquant comment configurer le MCP avec Copilot ou Augment</li><li>exposer proprement lâ€™API</li><li>documenter tout Ã§a avec Swagger</li></ul><p>Les sources du MCP server, ainsi quâ€™une page Markdown expliquant son fonctionnement, sont disponibles ici :</p><p>ğŸ‘‰ <a href=https://github.com/thlg057/mo5-mcp-server>https://github.com/thlg057/mo5-mcp-server</a></p><hr><h2 id=choix-de-lhÃ©bergement>Choix de lâ€™hÃ©bergement<a hidden class=anchor aria-hidden=true href=#choix-de-lhÃ©bergement>#</a></h2><p>Je voulais pouvoir dÃ©ployer <strong>mon image Docker</strong> simplement.<br>En regardant ce qui se faisait, je suis rapidement arrivÃ© sur les <strong>VPS</strong>.</p><p>AprÃ¨s comparaison des prix et des configurations, je suis parti sur :</p><ul><li><strong>Hostinger â€“ offre KVM1</strong></li><li>4,99 â‚¬ / mois</li><li>1 vCPU</li><li>4 Go de RAM</li></ul><p>Ce nâ€™est pas une grosse config, mais Ã§a devrait Ãªtre suffisant pour mon usage.<br>Bonus apprÃ©ciable : <strong>le nom de domaine offert</strong>, parfait pour donner une vraie URL au projet.</p><p><img alt=Hostinger loading=lazy src=https://thlg057.github.io/mo5-blog/assets/hostinger.png title="Hostinger hosting"></p><hr><h2 id=architecture-de-dÃ©ploiement>Architecture de dÃ©ploiement<a hidden class=anchor aria-hidden=true href=#architecture-de-dÃ©ploiement>#</a></h2><p>Pour la gestion des URLs, jâ€™ai choisi <strong>Caddy</strong>.</p><p>Lâ€™idÃ©e est simple :</p><ul><li><code>/</code> â†’ redirection vers mon blog</li><li><code>/api</code> â†’ mon API RAG</li><li><code>/swagger</code> â†’ documentation interactive de lâ€™API</li></ul><p>CÃ´tÃ© serveur, jâ€™ai prÃ©parÃ© un rÃ©pertoire de dÃ©ploiement avec :</p><ul><li>le blog (Hugo)</li><li>les sources de lâ€™API</li><li>un <code>docker-compose.yml</code></li><li>la configuration Caddy</li></ul><p>Copie du tout sur le VPS Hostinger, installationâ€¦ <strong>aucun souci particulier</strong>, câ€™est plutÃ´t simple et bien foutu.</p><hr><h2 id=premier-choc--les-performances>Premier choc : les performances<a hidden class=anchor aria-hidden=true href=#premier-choc--les-performances>#</a></h2><p>Sur mon Raspberry Pi 4, jâ€™avais dÃ©jÃ  remarquÃ© un problÃ¨me : <strong>environ 30 secondes</strong> pour obtenir une rÃ©ponse.</p><p>Dâ€™aprÃ¨s Augment, le diagnostic Ã©tait clair : le Raspberry nâ€™Ã©tait tout simplement <strong>pas assez puissant</strong>.</p><p>Je mâ€™attendais donc Ã  une amÃ©lioration nette sur le VPS.</p><p>Premier test en productionâ€¦ <strong>catastrophe</strong> : toujours ~30 secondes, et des rÃ©sultats pas terribles ğŸ˜¬.</p><p>Il fallait clairement creuser&mldr;</p><hr><h2 id=1-performance-et-architecture-vitesse>1. Performance et architecture (vitesse)<a hidden class=anchor aria-hidden=true href=#1-performance-et-architecture-vitesse>#</a></h2><h3 id=le-problÃ¨me>Le problÃ¨me<a hidden class=anchor aria-hidden=true href=#le-problÃ¨me>#</a></h3><p>Au dÃ©part, jâ€™utilisais un service dâ€™<strong>embedding local</strong> :</p><ul><li>le code .NET appelait des scripts Python</li><li>le modÃ¨le Ã©tait chargÃ© Ã  la volÃ©e</li></ul><p>RÃ©sultat :</p><ul><li>chargement du modÃ¨le Ã  chaque requÃªte</li><li>CPU saturÃ©</li><li>application instable</li></ul><p>Au dÃ©but, je pensais que le problÃ¨me venait de la base de donnÃ©es (mauvaises requÃªtes, index mal optimisÃ©s, etc.).</p><p>AprÃ¨s avoir ajoutÃ© pas mal de logs, le verdict est tombÃ© : <strong>la base nâ€™Ã©tait pas en cause</strong>, mais bien la gÃ©nÃ©ration des <em>chunks</em> et des embeddings.</p><h3 id=analyse>Analyse<a hidden class=anchor aria-hidden=true href=#analyse>#</a></h3><p>Charger un modÃ¨le de deep learning (mÃªme â€œpetitâ€ comme E5) est une opÃ©ration lourde. Le faire Ã  chaque requÃªte est totalement inefficace.</p><p>Il fallait une architecture oÃ¹ le modÃ¨le reste <strong>â€œchaudâ€</strong>, chargÃ© une seule fois en mÃ©moire.</p><h3 id=ce-qui-a-Ã©tÃ©-mis-en-place>Ce qui a Ã©tÃ© mis en place<a hidden class=anchor aria-hidden=true href=#ce-qui-a-Ã©tÃ©-mis-en-place>#</a></h3><ul><li><p><strong>Micro-service dÃ©diÃ©</strong><br>Une API Python indÃ©pendante, basÃ©e sur FastAPI, dans son propre conteneur Docker.</p></li><li><p><strong>Chargement unique du modÃ¨le</strong><br>Le modÃ¨le <code>multilingual-e5-small</code> est chargÃ© <strong>une seule fois</strong> au dÃ©marrage du service.</p></li><li><p><strong>Communication HTTP</strong><br>Le serveur .NET communique dÃ©sormais via des requÃªtes JSON rapides et simples.</p></li></ul><h3 id=rÃ©sultat>RÃ©sultat<a hidden class=anchor aria-hidden=true href=#rÃ©sultat>#</a></h3><p>Le temps de traitement est passÃ© :</p><ul><li>de plusieurs secondes <strong>par chunk</strong></li><li>Ã  <strong>quelques millisecondes</strong></li></ul><p>LÃ , on commence Ã  respirer.</p><hr><h2 id=2-qualitÃ©-de-la-recherche-similarityscore>2. QualitÃ© de la recherche (SimilarityScore)<a hidden class=anchor aria-hidden=true href=#2-qualitÃ©-de-la-recherche-similarityscore>#</a></h2><h3 id=le-problÃ¨me-1>Le problÃ¨me<a hidden class=anchor aria-hidden=true href=#le-problÃ¨me-1>#</a></h3><p>Avec le modÃ¨le initial :</p><ul><li>scores de similaritÃ© autour de <strong>0.60</strong></li><li>rÃ©sultats souvent peu pertinents</li><li>sections gÃ©nÃ©riques du type <em>â€œErrors to avoidâ€</em> qui remontaient tout le temps</li></ul><p>Bref, lâ€™IA avait du mal Ã  comprendre les nuances techniques spÃ©cifiques du MO5.</p><h3 id=analyse-1>Analyse<a hidden class=anchor aria-hidden=true href=#analyse-1>#</a></h3><p>Deux causes principales :</p><h4 id=1-le-modÃ¨le>1. Le modÃ¨le<a hidden class=anchor aria-hidden=true href=#1-le-modÃ¨le>#</a></h4><p>Le modÃ¨le dâ€™origine nâ€™Ã©tait pas assez performant sur :</p><ul><li>le langage technique</li><li>le multilingue (franÃ§ais / anglais)</li></ul><h4 id=2-la-perte-de-contexte>2. La perte de contexte<a hidden class=anchor aria-hidden=true href=#2-la-perte-de-contexte>#</a></h4><p>Une fois dÃ©coupÃ© en <em>chunks</em>, le moteur :</p><ul><li>voyait une suite dâ€™instructions</li><li>mais oubliait <strong>de quel document et de quelle section</strong> elles provenaient</li></ul><p>Par exemple, il ne savait plus si on parlait :</p><ul><li>du mode texte</li><li>ou du mode graphique</li></ul><h3 id=ce-qui-a-Ã©tÃ©-mis-en-place-1>Ce qui a Ã©tÃ© mis en place<a hidden class=anchor aria-hidden=true href=#ce-qui-a-Ã©tÃ©-mis-en-place-1>#</a></h3><ul><li><p><strong>Changement de modÃ¨le</strong><br>Passage Ã  <code>intfloat/multilingual-e5-small</code> â†’ le score de base est passÃ© de <strong>0.61 Ã  0.86</strong></p></li><li><p><strong>Enrichissement sÃ©mantique</strong><br>Modification du code C# pour injecter :</p><ul><li>le titre du document</li><li>le titre de la section<br>dans chaque chunk envoyÃ© Ã  lâ€™IA</li></ul></li><li><p><strong>Nettoyage du Markdown</strong><br>Suppression des caractÃ¨res <code>#</code>, <code>**</code>, etc. pour ne conserver que le texte â€œpurâ€ lors de lâ€™indexation</p></li></ul><h3 id=rÃ©sultat-1>RÃ©sultat<a hidden class=anchor aria-hidden=true href=#rÃ©sultat-1>#</a></h3><p>Les documents techniques remontent dÃ©sormais <strong>en prioritÃ© nÂ°1</strong> sur les requÃªtes matÃ©rielles (par exemple sur le NMI).
Lâ€™IA â€œcomprendâ€ enfin le <strong>contexte global</strong> de chaque page.</p><hr><h2 id=fine-tuning-empirique>Fine tuning empirique<a hidden class=anchor aria-hidden=true href=#fine-tuning-empirique>#</a></h2><p>Jâ€™ai fait pas mal de tests pour affiner le comportement :</p><ul><li>suppression des <code>#</code>, <code>*</code>, etc.</li><li>taille des chunks</li><li>taille de lâ€™overlap</li><li>ordre des champs injectÃ©s dans le contexte</li></ul><p>Tout a Ã©tÃ© fait de maniÃ¨re <strong>empirique</strong>, Ã  coups de tests et de comparaisons.</p><hr><h2 id=aide-prÃ©cieuse-des-ia>Aide prÃ©cieuse des IA<a hidden class=anchor aria-hidden=true href=#aide-prÃ©cieuse-des-ia>#</a></h2><p>Je ne connais pas grand-chose aux modÃ¨les neuronaux.<br>Sur ce point :</p><ul><li><strong>Gemini</strong> mâ€™a beaucoup aidÃ©<ul><li>pour le dÃ©ploiement du service Python</li><li>pour le choix du modÃ¨le <code>multilingual-e5-small</code></li></ul></li></ul><p>Franchement, sans cette aide, Ã§a aurait Ã©tÃ© beaucoup plus long (et probablement plus douloureux ğŸ˜…).</p><hr><h2 id=tester-le-rag-en-pratique>Tester le RAG en pratique<a hidden class=anchor aria-hidden=true href=#tester-le-rag-en-pratique>#</a></h2><p>Pour tester concrÃ¨tement le RAG, le plus simple est de passer par le site :
ğŸ‘‰ <a href=https://retrocomputing-ai.cloud/>https://retrocomputing-ai.cloud/</a></p><p>Câ€™est une page de blog qui explique pas Ã  pas comment utiliser le serveur via un <strong>coding agent</strong> (Copilot, Augment, etc.) en sâ€™appuyant sur le serveur MCP.</p><p>Si vous voulez simplement explorer lâ€™API sans passer par un agent, la documentation Swagger est disponible ici :
ğŸ‘‰ <a href=https://retrocomputing-ai.cloud/swagger>https://retrocomputing-ai.cloud/swagger</a></p><p>Vous y trouverez la liste complÃ¨te des endpoints, les formats de requÃªtes et des exemples dâ€™appels pour tester rapidement le RAG.</p><hr><h2 id=Ã©tat-actuel-de-la-documentation>Ã‰tat actuel de la documentation<a hidden class=anchor aria-hidden=true href=#Ã©tat-actuel-de-la-documentation>#</a></h2><p>La documentation utilisÃ©e par le RAG est encore <strong>en cours de mise Ã  jour</strong>.</p><p>Suite Ã  mes derniÃ¨res explorations du code du MO5 â€” et en particulier tout ce qui concerne les <strong>modes graphiques</strong>, je suis en train de revoir et dâ€™enrichir les fichiers de documentation.</p><p>Cela signifie que :</p><ul><li>certaines parties sont dÃ©jÃ  trÃ¨s prÃ©cises (notamment sur le matÃ©riel)</li><li>dâ€™autres vont encore Ã©voluer au fil des ajouts</li><li>les rÃ©sultats du RAG vont continuer Ã  sâ€™amÃ©liorer Ã  mesure que la documentation se densifie</li></ul><p>Bref, le serveur est opÃ©rationnel, mais le contenu quâ€™il exploite est encore vivant (et câ€™est aussi ce qui rend lâ€™expÃ©rience intÃ©ressante).</p><hr><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>Ce dÃ©ploiement mâ€™a permis de comprendre une chose essentielle :</p><blockquote><p>Un RAG qui â€œfonctionneâ€ nâ€™est pas forcÃ©ment un RAG <strong>utilisable</strong>.</p></blockquote><p>Entre :</p><ul><li>lâ€™architecture</li><li>la performance</li><li>la qualitÃ© des embeddings</li><li>le contexte injectÃ©</li></ul><p>il y a Ã©normÃ©ment de paramÃ¨tres Ã  ajuster.</p><p>Mais une fois les bons choix faits, le gain est <strong>immÃ©diat</strong> et vraiment satisfaisant.</p><p>La suite au prochain Ã©pisode ğŸ™‚</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://thlg057.github.io/mo5-blog/tags/mo5/>MO5</a></li><li><a href=https://thlg057.github.io/mo5-blog/tags/rag/>RAG</a></li><li><a href=https://thlg057.github.io/mo5-blog/tags/ai/>AI</a></li><li><a href=https://thlg057.github.io/mo5-blog/tags/mcp/>MCP</a></li><li><a href=https://thlg057.github.io/mo5-blog/tags/docker/>Docker</a></li><li><a href=https://thlg057.github.io/mo5-blog/tags/vps/>Vps</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>