<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Day 8 ‚Äì My First Functional Tutorials for the Thomson MO5 | Thomson MO5 Development: First Steps</title><meta name=keywords content="AI,MO5,Assembly,Retro"><meta name=description content="Eighth day of vibe coding: I finally have a real program (well, a sample) that actually works üò¢"><meta name=author content><link rel=canonical href=https://thlg057.github.io/mo5-blog/en/days/day-8-my-first-mo5-programs/><link crossorigin=anonymous href=https://thlg057.github.io/mo5-blog/assets/css/stylesheet.a090830a421002426baafbd314e38f149d77b4c48a12ee9312700d770b27fb26.css integrity="sha256-oJCDCkIQAkJrqvvTFOOPFJ13tMSKEu6TEnANdwsn+yY=" rel="preload stylesheet" as=style><link rel=icon href=https://thlg057.github.io/mo5-blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://thlg057.github.io/mo5-blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://thlg057.github.io/mo5-blog/favicon-32x32.png><link rel=apple-touch-icon href=https://thlg057.github.io/mo5-blog/apple-touch-icon.png><link rel=mask-icon href=https://thlg057.github.io/mo5-blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=fr href=https://thlg057.github.io/mo5-blog/days/day-8-my-first-mo5-programs/><link rel=alternate hreflang=en href=https://thlg057.github.io/mo5-blog/en/days/day-8-my-first-mo5-programs/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-WRQSQ5Y81F"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-WRQSQ5Y81F")}</script><meta property="og:url" content="https://thlg057.github.io/mo5-blog/en/days/day-8-my-first-mo5-programs/"><meta property="og:site_name" content="Thomson MO5 Development: First Steps"><meta property="og:title" content="Day 8 ‚Äì My First Functional Tutorials for the Thomson MO5"><meta property="og:description" content="Eighth day of vibe coding: I finally have a real program (well, a sample) that actually works üò¢"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="days"><meta property="article:published_time" content="2025-12-27T00:00:00+00:00"><meta property="article:modified_time" content="2025-12-27T00:00:00+00:00"><meta property="article:tag" content="AI"><meta property="article:tag" content="MO5"><meta property="article:tag" content="Assembly"><meta property="article:tag" content="Retro"><meta name=twitter:card content="summary"><meta name=twitter:title content="Day 8 ‚Äì My First Functional Tutorials for the Thomson MO5"><meta name=twitter:description content="Eighth day of vibe coding: I finally have a real program (well, a sample) that actually works üò¢"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Days","item":"https://thlg057.github.io/mo5-blog/en/days/"},{"@type":"ListItem","position":2,"name":"Day 8 ‚Äì My First Functional Tutorials for the Thomson MO5","item":"https://thlg057.github.io/mo5-blog/en/days/day-8-my-first-mo5-programs/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Day 8 ‚Äì My First Functional Tutorials for the Thomson MO5","name":"Day 8 ‚Äì My First Functional Tutorials for the Thomson MO5","description":"Eighth day of vibe coding: I finally have a real program (well, a sample) that actually works üò¢","keywords":["AI","MO5","Assembly","Retro"],"articleBody":"Following Day 7, I reached an important milestone in my exploration of C development on the Thomson MO5:\nI finally had two fully functional tutorials.\nThey were still simple, but they were stable, reproducible, and understandable.\nAt that point, they relied on two very different approaches:\none tutorial using my home-made string, stdio, and ctype libraries another tutorial based exclusively on cmoc.h It was the right moment to step back and analyze what CMOC really provides.\nTaking a closer look at cmoc.h By examining cmoc.h more carefully, several observations became obvious.\nString handling All the functions I had implemented in my custom string library already existed in CMOC.\nThey were not only present, but correctly implemented and stable.\nFrom that point on, maintaining a home-made string library no longer made much sense.\nStandard input / output (stdio) Here, the situation was more subtle.\nSome important functions were missing, notably getchar().\nThis function was essential for me, because it allows simple interactions such as:\nPress Y to continue\nCMOC provides readline(), but it reads a full line and only stops when the user presses ENTER.\nIn terms of user experience, this is clearly less pleasant when you want to react to a single key press.\nCharacter classification (ctype) In this case, my home-made library still made sense.\nCMOC only provides:\nisupper() islower() Other functions (isdigit, isalpha, etc.) were still missing and useful in my programs.\nTowards a hybrid approach The conclusion was quite natural.\nI did not want to reinvent the wheel, nor did I want to give up what CMOC already does correctly.\nA hybrid approach therefore imposed itself:\nuse CMOC where it makes sense complement it with custom implementations when necessary At first, I thought about having my libraries include cmoc.h, and having programs include only my headers.\nBut since my string library had become useless, that idea quickly felt awkward.\nThe final solution was much simpler:\ncmoc.h is included directly only missing functions are provided by complementary libraries Issues and points of attention encountered As soon as I started writing slightly more ambitious programs, several important pitfalls appeared.\nThese are classic problems on 8-bit machines, but they are far from obvious today.\n1. Display and the system monitor The Thomson MO5 uses a BIOS-driven display state machine.\nSome ASCII codes are interpreted as commands.\nThe newline secret On the MO5:\n\\n (ASCII 10) moves the cursor down one line it does not return to column 0 For a proper newline, you must also send:\n\\r (ASCII 13) This is a very common source of misaligned output.\nTiming issues The MO5 display logic is sensitive to timing.\nIf output calls are chained too quickly (for example fputs() followed by mo5_newline()), the video processor may receive bytes during a scrolling operation.\nResult:\ntechnical glyphs incoherent characters corrupted display Solution: always group the text and the newline in a single call, for example:\nfputs(‚ÄúSome text\\n‚Äù);\n2. Critical stack management The Motorola 6809 has very limited memory, and by default the stack is extremely small.\nSymptom The program:\nbehaves randomly crashes for no apparent reason displays weird stuff on screen or breaks as soon as you declare: char buffer[25];\nAfter several tests (compilation + running in DCMOTO), I identified that the problem came from this seemingly harmless declaration, and I did not understand why. Gemini came to my rescue by providing the explanation.\nCause The stack grows downward in memory.\nIf it becomes too large, it overwrites:\nsystem monitor variables video memory From that point on, the behavior becomes completely unpredictable.\nRemedies Increase the stack size in the Makefile:\n‚Äìstack-space=512\nOr use static for buffers (this is what I did):\nstatic char buffer[30];\nThe variable is then placed in a fixed area of RAM.\n3. Strings: the number one source of crashes On 8-bit machines, string manipulation is the main cause of crashes.\nThe strcat() trap Never do this:\nstrcat(dest, \u0026ch);\nstrcat() expects a null-terminated string.\nBy passing the address of a single character, it will read memory until it randomly encounters a zero.\nSafe alternative int len = strlen(dest); dest[len] = ch; dest[len + 1] = ‚Äò\\0‚Äô;\nAlways explicitly close the string.\nThe null terminator Every string construction or conversion function (for example itoa) must explicitly append a final \\0.\nOtherwise, functions like fputs() or puts() will never stop.\nConclusion Day 8 marks the moment when things started to become concrete.\nI was no longer just experimenting, but with:\nfunctional examples a better understanding of CMOC‚Äôs strengths and limitations a very clear awareness of hardware constraints This hybrid approach turned out to be a good compromise.\nAnd above all, it forced me to think like an 8-bit developer, where every byte, every call, and every timing matters. With modern development tools, these kinds of reflexes are not natural. On a daily basis, I mostly develop .NET microservices, where code readability is the priority and memory footprint is rarely a concern. Here, it is a completely different world. But going back to fundamentals, with strong and explicit constraints, often does a lot of good üòâ.\nThe code associated with this article is available here:\nhttps://github.com/thlg057/mo5-tuto\n","wordCount":"853","inLanguage":"en","datePublished":"2025-12-27T00:00:00Z","dateModified":"2025-12-27T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://thlg057.github.io/mo5-blog/en/days/day-8-my-first-mo5-programs/"},"publisher":{"@type":"Organization","name":"Thomson MO5 Development: First Steps","logo":{"@type":"ImageObject","url":"https://thlg057.github.io/mo5-blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://thlg057.github.io/mo5-blog/en/ accesskey=h title="Thomson MO5 Development: First Steps (Alt + H)">Thomson MO5 Development: First Steps</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://thlg057.github.io/mo5-blog/ title=Fran√ßais aria-label=Fran√ßais>Fr</a></li></ul></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Day 8 ‚Äì My First Functional Tutorials for the Thomson MO5</h1><div class=post-description>Eighth day of vibe coding: I finally have a real program (well, a sample) that actually works üò¢</div><div class=post-meta><span title='2025-12-27 00:00:00 +0000 UTC'>December 27, 2025</span>&nbsp;|&nbsp;<span>Translations:</span><ul class=i18n_list><li><a href=https://thlg057.github.io/mo5-blog/days/day-8-my-first-mo5-programs/>Fr</a></li></ul></div></header><div class=post-content><p>Following Day 7, I reached an important milestone in my exploration of C development on the Thomson MO5:<br>I finally had two fully functional tutorials.</p><p>They were still simple, but they were stable, reproducible, and understandable.</p><p>At that point, they relied on two very different approaches:</p><ul><li>one tutorial using my home-made string, stdio, and ctype libraries</li><li>another tutorial based exclusively on cmoc.h</li></ul><p>It was the right moment to step back and analyze what CMOC really provides.</p><hr><h2 id=taking-a-closer-look-at-cmoch>Taking a closer look at cmoc.h<a hidden class=anchor aria-hidden=true href=#taking-a-closer-look-at-cmoch>#</a></h2><p>By examining cmoc.h more carefully, several observations became obvious.</p><h3 id=string-handling>String handling<a hidden class=anchor aria-hidden=true href=#string-handling>#</a></h3><p>All the functions I had implemented in my custom string library already existed in CMOC.</p><p>They were not only present, but correctly implemented and stable.</p><p>From that point on, maintaining a home-made string library no longer made much sense.</p><hr><h3 id=standard-input--output-stdio>Standard input / output (stdio)<a hidden class=anchor aria-hidden=true href=#standard-input--output-stdio>#</a></h3><p>Here, the situation was more subtle.</p><p>Some important functions were missing, notably getchar().</p><p>This function was essential for me, because it allows simple interactions such as:</p><p>Press Y to continue</p><p>CMOC provides readline(), but it reads a full line and only stops when the user presses ENTER.</p><p>In terms of user experience, this is clearly less pleasant when you want to react to a single key press.</p><hr><h3 id=character-classification-ctype>Character classification (ctype)<a hidden class=anchor aria-hidden=true href=#character-classification-ctype>#</a></h3><p>In this case, my home-made library still made sense.</p><p>CMOC only provides:</p><ul><li>isupper()</li><li>islower()</li></ul><p>Other functions (isdigit, isalpha, etc.) were still missing and useful in my programs.</p><hr><h2 id=towards-a-hybrid-approach>Towards a hybrid approach<a hidden class=anchor aria-hidden=true href=#towards-a-hybrid-approach>#</a></h2><p>The conclusion was quite natural.</p><p>I did not want to reinvent the wheel, nor did I want to give up what CMOC already does correctly.</p><p>A hybrid approach therefore imposed itself:</p><ul><li>use CMOC where it makes sense</li><li>complement it with custom implementations when necessary</li></ul><p>At first, I thought about having my libraries include cmoc.h, and having programs include only my headers.</p><p>But since my string library had become useless, that idea quickly felt awkward.</p><p>The final solution was much simpler:</p><ul><li>cmoc.h is included directly</li><li>only missing functions are provided by complementary libraries</li></ul><hr><h2 id=issues-and-points-of-attention-encountered>Issues and points of attention encountered<a hidden class=anchor aria-hidden=true href=#issues-and-points-of-attention-encountered>#</a></h2><p>As soon as I started writing slightly more ambitious programs, several important pitfalls appeared.</p><p>These are classic problems on 8-bit machines, but they are far from obvious today.</p><hr><h2 id=1-display-and-the-system-monitor>1. Display and the system monitor<a hidden class=anchor aria-hidden=true href=#1-display-and-the-system-monitor>#</a></h2><p>The Thomson MO5 uses a BIOS-driven display state machine.<br>Some ASCII codes are interpreted as commands.</p><h3 id=the-newline-secret>The newline secret<a hidden class=anchor aria-hidden=true href=#the-newline-secret>#</a></h3><p>On the MO5:</p><ul><li>\n (ASCII 10) moves the cursor down one line</li><li>it does not return to column 0</li></ul><p>For a proper newline, you must also send:</p><ul><li>\r (ASCII 13)</li></ul><p>This is a very common source of misaligned output.</p><hr><h3 id=timing-issues>Timing issues<a hidden class=anchor aria-hidden=true href=#timing-issues>#</a></h3><p>The MO5 display logic is sensitive to timing.</p><p>If output calls are chained too quickly (for example fputs() followed by mo5_newline()), the video processor may receive bytes during a scrolling operation.</p><p>Result:</p><ul><li>technical glyphs</li><li>incoherent characters</li><li>corrupted display</li></ul><p>Solution: always group the text and the newline in a single call, for example:</p><p>fputs(&ldquo;Some text\n&rdquo;);</p><hr><h2 id=2-critical-stack-management>2. Critical stack management<a hidden class=anchor aria-hidden=true href=#2-critical-stack-management>#</a></h2><p>The Motorola 6809 has very limited memory, and by default the stack is extremely small.</p><h3 id=symptom>Symptom<a hidden class=anchor aria-hidden=true href=#symptom>#</a></h3><p>The program:</p><ul><li>behaves randomly</li><li>crashes for no apparent reason</li><li>displays weird stuff on screen</li><li>or breaks as soon as you declare:</li></ul><p>char buffer[25];</p><p>After several tests (compilation + running in DCMOTO), I identified that the problem came from this seemingly harmless declaration, and I did not understand why.
Gemini came to my rescue by providing the explanation.</p><hr><h3 id=cause>Cause<a hidden class=anchor aria-hidden=true href=#cause>#</a></h3><p>The stack grows downward in memory.</p><p>If it becomes too large, it overwrites:</p><ul><li>system monitor variables</li><li>video memory</li></ul><p>From that point on, the behavior becomes completely unpredictable.</p><hr><h3 id=remedies>Remedies<a hidden class=anchor aria-hidden=true href=#remedies>#</a></h3><p>Increase the stack size in the Makefile:</p><p>&ndash;stack-space=512</p><p>Or use static for buffers (this is what I did):</p><p>static char buffer[30];</p><p>The variable is then placed in a fixed area of RAM.</p><hr><h2 id=3-strings-the-number-one-source-of-crashes>3. Strings: the number one source of crashes<a hidden class=anchor aria-hidden=true href=#3-strings-the-number-one-source-of-crashes>#</a></h2><p>On 8-bit machines, string manipulation is the main cause of crashes.</p><h3 id=the-strcat-trap>The strcat() trap<a hidden class=anchor aria-hidden=true href=#the-strcat-trap>#</a></h3><p>Never do this:</p><p>strcat(dest, &amp;ch);</p><p>strcat() expects a null-terminated string.</p><p>By passing the address of a single character, it will read memory until it randomly encounters a zero.</p><hr><h3 id=safe-alternative>Safe alternative<a hidden class=anchor aria-hidden=true href=#safe-alternative>#</a></h3><p>int len = strlen(dest);
dest[len] = ch;
dest[len + 1] = &lsquo;\0&rsquo;;</p><p>Always explicitly close the string.</p><hr><h3 id=the-null-terminator>The null terminator<a hidden class=anchor aria-hidden=true href=#the-null-terminator>#</a></h3><p>Every string construction or conversion function (for example itoa) must explicitly append a final \0.</p><p>Otherwise, functions like fputs() or puts() will never stop.</p><hr><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>Day 8 marks the moment when things started to become concrete.</p><p>I was no longer just experimenting, but with:</p><ul><li>functional examples</li><li>a better understanding of CMOC‚Äôs strengths and limitations</li><li>a very clear awareness of hardware constraints</li></ul><p>This hybrid approach turned out to be a good compromise.</p><p>And above all, it forced me to think like an 8-bit developer, where every byte, every call, and every timing matters.
With modern development tools, these kinds of reflexes are not natural.
On a daily basis, I mostly develop .NET microservices, where code readability is the priority and memory footprint is rarely a concern.
Here, it is a completely different world.
But going back to fundamentals, with strong and explicit constraints, often does a lot of good üòâ.</p><p>The code associated with this article is available here:<br><a href=https://github.com/thlg057/mo5-tuto>https://github.com/thlg057/mo5-tuto</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://thlg057.github.io/mo5-blog/en/tags/ai/>AI</a></li><li><a href=https://thlg057.github.io/mo5-blog/en/tags/mo5/>MO5</a></li><li><a href=https://thlg057.github.io/mo5-blog/en/tags/assembly/>Assembly</a></li><li><a href=https://thlg057.github.io/mo5-blog/en/tags/retro/>Retro</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>